---
/**
 * Leaderboard Component (Alpine.js)
 *
 * Displays real-time participant rankings with scores and streaks.
 * Uses the registered 'leaderboard' Alpine component from alpine/leaderboard.ts
 */

interface Props {
    roomId: string;
    showTitle?: boolean;
}

const { roomId, showTitle = false } = Astro.props;
---

<div
    x-data={`leaderboard({ roomId: '${roomId}' })`}
    x-init="init()"
    class="bg-white rounded-lg shadow-lg p-6"
>
    {showTitle && <h2 class="text-2xl font-bold mb-4">Leaderboard</h2>}

    <template x-if="isEmpty">
        <p class="text-gray-500 text-center py-8">
            Waiting for participants...
        </p>
    </template>

    <div x-show="!isEmpty" class="space-y-2">
        <template x-for="player in leaderboard" :key="player.participant_id">
            <div
                :class="{
          'bg-yellow-100 border-2 border-yellow-400': player.rank === 1,
          'bg-gray-100 border-2 border-gray-400': player.rank === 2,
          'bg-orange-100 border-2 border-orange-400': player.rank === 3,
          'bg-blue-50 border-2 border-blue-200': player.rank > 3 || player.rank <= 0
        }"
                class="flex items-center justify-between p-3 rounded"
            >
                <div class="flex items-center gap-3">
                    <div
                        class="text-2xl w-8"
                        x-text="getRankEmoji(player.rank)"
                    >
                    </div>

                    <div>
                        <div class="font-semibold" x-text="player.nickname">
                        </div>

                        <template x-if="player.streak > 0">
                            <div class="text-xs text-orange-600">
                                ðŸ”¥ <span x-text="player.streak"></span> streak
                            </div>
                        </template>
                    </div>
                </div>

                <div
                    class="text-xl font-bold text-blue-600"
                    x-text="player.score.toLocaleString()"
                >
                </div>
            </div>
        </template>
    </div>
</div>
