---
/**
 * Question Component
 *
 * Reusable component for displaying quiz questions in both host and player views.
 * Uses mode-based rendering to show different content based on the view context.
 *
 * Props:
 * - question: The question collection entry with markdown content
 * - questionIndex: The display index (0-based)
 * - mode: "host" | "player" - determines what content to show
 * - isVisible: Whether this question is currently visible (controlled by parent)
 *
 * Slots:
 * - actions: Custom content slot for buttons, answer inputs, etc.
 */

import type { CollectionEntry } from "astro:content";
import { render } from "astro:content";
import QuestionDetails from "./QuestionDetails.astro";

interface Props {
    question: CollectionEntry<"quiz">;
    questionIndex: number;
    mode: "host" | "player";
}

const { question, questionIndex, mode } = Astro.props;
const { Content } = await render(question);
const isHost = mode === "host";
---

<div
    x-show={`currentQuestion === ${questionIndex}`}
    x-cloak
    class="question-container"
    data-question-index={questionIndex}
    data-mode={mode}
>
    <!-- Question Text Content -->
    <div class="text-lg mb-4">
        <Content />
    </div>

    <!-- Host Mode: Show Options List -->
    {
        isHost && question.data.type === "multiple-choice" && (
            <div class="mt-3 space-y-2">
                <p class="text-sm font-semibold text-gray-700">Options:</p>
                <ul class="list-disc list-inside space-y-1">
                    {question.data.options?.map((option) => (
                        <li class="text-gray-600">{option}</li>
                    ))}
                </ul>
            </div>
        )
    }

    <!-- Host Mode: Show Metadata (type, time limit, points) -->
    {isHost && question.data && <QuestionDetails question={question} />}

    <!-- Slot for Custom Actions (submit button, answer highlighting, etc.) -->
    <slot name="actions" />
</div>
